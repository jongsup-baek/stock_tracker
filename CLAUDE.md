# CLAUDE.md

이 파일은 Claude가 stock_tracker 프로젝트를 이해하고 작업하는 데 필요한 정보를 담고 있습니다.

---

## ⚠️ Daily Report 작성 필수 프로세스

> **중요**: 아래 프로세스를 반드시 순서대로 따라야 합니다. 생략하면 종목 누락, 포맷 불일치 등의 문제가 발생합니다.

### 1단계: 문서 읽기 (작성 전)

Daily Report 작성 요청을 받으면, **작성 전에 반드시** 아래 문서들을 읽습니다:

1. `docs/OPERATION_GUIDE.md` - Daily Report 템플릿 및 섹션 구조 확인
2. `docs/OPERATION_MANUAL.md` - 매수/매도 규칙 확인
3. `docs/PORTFOLIO.md` - 관심 종목 6개 확인
4. Notion 매매 히스토리 - 보유 종목 및 매수가 확인

### 2단계: 데이터 수집

- `data/stock_*.json` 파일 **6개 종목 전체** 읽기
- 절대 종목을 빠뜨리지 않도록 PORTFOLIO.md와 대조
- **오늘 날짜와 어제 날짜 데이터 모두 확인** (전일비 계산용)

### 3단계: 작성

- OPERATION_GUIDE.md의 템플릿(섹션 1~7)에 맞춰 작성
- 넘버링 시스템 사용 (1., 1.1, 2., 2.1 ...)

### 4단계: 더블 체크 (작성 후)

작성 완료 후, 아래 체크리스트를 **반드시** 확인:

| 체크 항목 | 확인 방법 |
|----------|----------|
| 6개 종목 전체 포함? | PORTFOLIO.md와 대조 |
| 7개 섹션 모두 포함? | OPERATION_GUIDE.md 템플릿과 대조 |
| 매수 조건 4가지 점검? | OPERATION_MANUAL.md 규칙과 대조 |
| 익절/손절 기준 계산? | 익절 +15%, 손절 -7% |
| Action Items 구체적? | 종목, 가격, 수량, 금액 포함 |
| 전일비 정확히 계산? | JSON에서 어제/오늘 종가 직접 비교 |

### 5단계: 결과 보고

Daily Report 섹션 7에 더블 체크 결과 기록:
```
✅ 6개 종목 전체 데이터 확인
✅ 매수 조건 4가지 모두 점검
✅ 보유 종목 익절/손절 기준 계산
✅ 자금 관리 (매수 가능 여부) 확인
✅ 전일 대비 변동률 계산
```

### 6단계: 기존 레포트와 비교 검증

작성 완료 후, **반드시 최근 Daily Report(예: 1월 27일, 1월 23일)를 Notion에서 다시 읽고** 포맷이 일치하는지 확인:

1. Notion에서 기존 Daily Report 페이지 fetch
2. 섹션 구조 비교 (1~7번 모두 있는지)
3. 테이블 형식 비교 (종목 수, 컬럼 일치)
4. 누락된 항목이 있으면 즉시 수정

> **참고 레포트**: 2026년 1월 27일 (https://www.notion.so/2f5ef155d1718142a517d7f91eb9efdc)

---

## Notion 정보

### 주요 페이지 및 데이터베이스

| 항목 | ID | URL |
|------|-----|-----|
| 국내 시장 정보 (메인) | `2c0ef155d17180c99ff9c7d243962092` | https://www.notion.so/2c0ef155d17180c99ff9c7d243962092 |
| 매매 히스토리 (페이지) | `3bb47dea77dc4c398b49cf7c4fef1fe5` | https://www.notion.so/3bb47dea77dc4c398b49cf7c4fef1fe5 |
| Daily Report DB | `dfc9689988de437dbefdcd7a2a9b9184` | https://www.notion.so/dfc9689988de437dbefdcd7a2a9b9184 |
| Daily Report Data Source | `277dc1bd-56d7-466f-a991-aa45ed0c65fb` | (페이지 생성 시 사용) |

### Daily Report 생성 시 사용할 parent

```json
{"data_source_id": "277dc1bd-56d7-466f-a991-aa45ed0c65fb"}
```

---

## 기록 규칙

- **Daily Report Name**: "2026년 1월 27일" (날짜만, 요일 없음)
- **매매 히스토리**: 날짜별 섹션으로 기록 (DB 아님, 페이지 형식)
- **미체결 주문**: 해당 날짜 섹션에 "종목명 매수 미체결"로 기록

---

## Daily Report 필수 포맷

### 섹션 구조 (넘버링 시스템)

```
## 1. 시장 요약
### 1.1 전체 종목 현황
(6개 종목 전체 테이블)

## 2. 매수 조건 점검
### 2.1 매수 조건 분석
(6개 종목 4가지 조건 체크)
### 2.2+ 개별 종목 상세
(4/4 충족 또는 주의 필요 종목)

## 3. 포트폴리오 현황
### 3.1 자금 현황
### 3.2 보유 현황
### 3.3 익절/손절 기준

## 4. Action Items
### 4.1 내일 장 시작 전
(구체적 수치: 종목, 가격, 수량, 금액)
### 4.2 모니터링 가격

## 5. 자금 관리 점검

## 6. 특이사항

## 7. 더블 체크
```

---

## ⚠️ 전일비 계산 규칙 (재발 방지)

> **경고**: 이전에 전일비를 잘못 계산한 적이 있습니다. 아래 규칙을 반드시 따르세요.

### 전일비 계산 공식

```
전일비 = (오늘 종가 - 어제 종가) / 어제 종가 × 100
```

### 주의사항

1. **반드시 JSON 파일에서 직접 확인**
   - 오늘 날짜의 `종가` 값
   - 어제 날짜의 `종가` 값
   - 두 값을 직접 비교해서 계산

2. **혼동하지 말 것**
   - ❌ 시가 대비 종가 변동률 (일간 변동률)
   - ❌ 이전 세션에서 계산한 값 재사용
   - ❌ 컨텍스트 요약에 있는 값 그대로 사용
   - ✅ 항상 원본 JSON 데이터에서 새로 계산

3. **검증 방법**
   ```
   예: SK하이닉스
   - 1/26 종가: 736,000원
   - 1/27 종가: 800,000원
   - 전일비: (800,000 - 736,000) / 736,000 = +8.7%
   ```

---

## 관심 종목 (6개) - 절대 누락 금지!

1. 삼성전자 (005930)
2. SK하이닉스 (000660)
3. 한화시스템 (272210)
4. 현대모비스 (012330)
5. 한화에어로스페이스 (012450)
6. HD현대일렉트릭 (267260)

---

## 로컬 경로

- 프로젝트 경로: `~/jongsup-baek.github/stock_tracker`
- 주가 데이터: `data/stock_XXXXXX.json`

---

## 주요 문서

| 문서 | 용도 | 언제 읽나? |
|------|------|----------|
| `README.md` | 워크플로우 시작점 | 세션 시작 시 |
| `docs/OPERATION_GUIDE.md` | Daily Report 템플릿 | **Daily Report 작성 전 필수** |
| `docs/OPERATION_MANUAL.md` | 투자 규칙 (정배열, 매수/매도) | **Daily Report 작성 전 필수** |
| `docs/PORTFOLIO.md` | 관심 종목 목록 | **Daily Report 작성 전 필수** |
| `DEVELOPMENT.md` | CLI 도구 사용법 | 개발 관련 질문 시 |
